<!DOCTYPE html>
<html lang="nl">
<head>
    <link
    rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"
    />
    <link rel="stylesheet" href="../assets/css/calc.css">
    <meta charset="UTF-8">
    <title>Revoloop Credit Calculator</title>
</head>

<style>
    body {
      font-family: "Inter", "Segoe UI", Roboto, Arial, sans-serif;
      background: #f5fff5;
      text-align: center;
      padding: 2rem;
    }

    form {
      max-width: 400px;
      margin: 0 auto;
      background: rgba(255, 255, 255, 0.85);
      padding: 1.5rem;
      border-radius: 12px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }

    label {
      display: block;
      margin-top: 1rem;
    }

    input, select {
      width: 100%;
      padding: 0.5rem;
      border-radius: 6px;
      border: 1px solid #ccc;
      margin-top: 0.3rem;
    }

    button {
      margin-top: 1rem;
      background-color: #228B22;
      color: white;
      border: none;
      padding: 0.75rem 1.5rem;
      border-radius: 8px;
      cursor: pointer;
      transition: background 0.3s ease;
    }

    button:hover {
      background-color: #006400;
    }

    #log {
      margin-top: 2rem;
      background: rgba(255, 255, 255, 0.7);
      padding: 1rem;
      border-radius: 10px;
      max-width: 800px;
      margin-left: auto;
      margin-right: auto;
      overflow-x: auto;
    }

    #log table {
      width: 100%;
      border-collapse: collapse;
    }

    #log th, #log td {
      border-bottom: 1px solid #ccc;
      padding: 0.5rem;
    }

    #log th {
      background: rgba(0, 100, 0, 0.1);
      color: #006400;
    }
</style>

<body>

<header>
  <nav>
    <ul>
      <li><a href="index.html">Home</a></li>
      <li><a href="shop.html">Winkel</a></li>
      <li><a href="about.html">Over Ons</a></li>
      <li><a href="services.html">Diensten</a></li>
      <li><a href="contact.html">Contact</a></li>
    </ul>
  </nav>

  <div class="translate-btn">
      <button onclick="location.href='../engels/calc.html'">üåê NL / EN</button>
  </div>
</header>

<section id="pla-calculator">
  <h2>Bereken je winkeltegoed</h2>
  <p>Lever je PLA-afval in en zie direct hoeveel winkeltegoed je ontvangt.</p>

  <form id="calc-form">
    <label for="email">E-mailadres (optioneel)</label>
    <input id="email" type="email" placeholder="jij@voorbeeld.com" />

    <label for="weight">Aantal kilogram PLA dat je inlevert</label>
    <input id="weight" type="number" min="0" step="0.01" value="1" required />

    <label for="quality">Conditie van het materiaal (‚Ç¨-waarde per kg)</label>
    <select id="quality">
      <option value="0.20">Gemengd / vervuild (‚Ç¨0,20/kg)</option>
      <option value="0.50" selected>Rein (‚Ç¨0,50/kg)</option>
      <option value="1.00">Gesorteerd & schoon (‚Ç¨1,00/kg)</option>
    </select>

    <label for="customer">Type klant</label>
    <select id="customer">
        <option value="Individu" selected>Individu</option>
        <option value="Makerspace">Makerspace</option>
        <option value="Overig">Overig</option>
    </select>

    <button type="button" id="calc">Bereken winkeltegoed (in centen)</button>
  </form>

  <div id="result" style="display:none; margin-top:1.5rem;">
    <h3>Je ontvangt:</h3>
    <p id="credit" style="font-size:1.5rem; font-weight:700; color:#006400;">0</p>
    <p id="note" style="color:#333;">‚Äî</p>
  </div>

  <div id="appointment" style="display:none; margin-top:1rem;">
    <button id="make-appointment">Maak afspraak</button>
  </div>
</section>

<section id="log">
  <h3>Berekeninggeschiedenis</h3>
  <table>
    <thead>
      <tr>
        <th>E-mail</th>
        <th>Klanttype</th>
        <th>Kilogram</th>
        <th>Conditiewaarde (cent/kg)</th>
        <th>Winkeltegoed (cent)</th>
        <th>Datum</th>
      </tr>
    </thead>
    <tbody id="log-body"></tbody>
  </table>
</section>

<script>
const el = id => document.getElementById(id);
const fmt = v => Number.isFinite(v)
  ? v.toLocaleString('nl-NL')
  : '‚Äî';

function loadLog() {
  const log = JSON.parse(localStorage.getItem('revoloopLogCent') || '[]');
  const tbody = el('log-body');
  tbody.innerHTML = '';

  log.forEach(entry => {
    const row = document.createElement('tr');
    row.innerHTML = `
      <td>${entry.email || '‚Äî'}</td>
      <td>${entry.customer}</td>
      <td>${entry.weight} kg</td>
      <td>${fmt(entry.qualityCent)}</td>
      <td>${fmt(entry.credit)}</td>
      <td>${entry.date}</td>
    `;
    tbody.appendChild(row);
  });
}

function saveLog(entry) {
  const log = JSON.parse(localStorage.getItem('revoloopLogCent') || '[]');
  log.unshift(entry);
  localStorage.setItem('revoloopLogCent', JSON.stringify(log));
}

function calculate() {
  const weight = parseFloat(el('weight').value) || 0;
  const valueEuro = parseFloat(el('quality').value) || 0;
  const valueCent = Math.round(valueEuro * 100);
  const customer = el('customer').value;
  const factor = 1.2;

  const credit = Math.round(weight * valueCent * factor);

  const email = el('email').value.trim();
  const date = new Date().toLocaleString('nl-NL');

  el('credit').textContent = fmt(credit);
  el('note').textContent = `${weight.toFixed(2)} kg √ó ${valueCent} cent/kg √ó 1,2 incentive`;
  el('result').style.display = 'block';

  const entry = {
    email,
    weight,
    qualityCent: valueCent,
    credit,
    customer,
    date
  };

  saveLog(entry);
  loadLog();
}

el('calc').addEventListener('click', () => {
  calculate();
  el('credit').animate([{ transform: 'scale(1.05)' }, { transform: 'scale(1)' }], { duration: 250 });
});

loadLog();

// After calculate() finishes, show appointment button
function showAppointmentButton() {
  document.getElementById('appointment').style.display = 'block';
}

document.getElementById('make-appointment').addEventListener('click', () => {
  const name = "afspraak_formulier.html";

  // HTML inhoud voor het formulier dat gedownload wordt
  const formHTML = `
<!DOCTYPE html>
<html lang="nl">
<head>
<meta charset="UTF-8">
<title>Afspraak maken</title>
<style>
  body {
    font-family: Arial, sans-serif;
    background:#f5fff5;
    padding:2rem;
    text-align:center;
  }
  form {
    background:white;
    padding:1.5rem;
    max-width:400px;
    margin:0 auto;
    border-radius:12px;
    box-shadow:0 0 10px rgba(0,0,0,0.1);
  }
  input {
    width:100%;
    padding:0.6rem;
    margin-top:0.5rem;
    border-radius:6px;
    border:1px solid #ccc;
  }
  button {
    margin-top:1rem;
    background:#228B22;
    color:white;
    border:none;
    padding:0.8rem;
    border-radius:8px;
    cursor:pointer;
  }
</style>
</head>
<body>

<h2>Maak een Afspraak</h2>
<p>Vul je gegevens in en klik op versturen.</p>

<form action="#" method="POST">
  <label>Naam</label>
  <input type="text" name="naam" required>

  <label>E-mail</label>
  <input type="email" name="email" required>

  <label>Adres</label>
  <input type="text" name="adres" required>

  <button type="submit">Versturen</button>
</form>

<p style="margin-top:1rem;color:#555;">
  ‚ö†Ô∏è Voeg hier jouw eigen verzend-URL/API toe.
</p>

</body>
</html>`;

  const blob = new Blob([formHTML], { type: "text/html" });
  const url = URL.createObjectURL(blob);

  const a = document.createElement("a");
  a.href = url;
  a.download = name;
  a.click();
  URL.revokeObjectURL(url);
});

showAppointmentButton();

</script>

</body>
</html>
