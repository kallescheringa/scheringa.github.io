<!doctype html>
<html lang="nl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Revoloop ‚Äî Shop</title>
  <style>
    :root{--accent:#2b8a78;--muted:#666}
    body{font-family:system-ui,-apple-system,Segoe UI,Roboto,'Helvetica Neue',Arial;margin:0;color:#222}
    header{background:#0b6;display:flex;align-items:center;justify-content:space-between;padding:1rem;color:white;background:linear-gradient(90deg,#0b6, #04735a)}
    header nav ul{list-style:none;padding:0;margin:0;display:flex;gap:1rem}
    header nav a{color:white;text-decoration:none;font-weight:600}
    .translate-btn button{background:transparent;border:1px solid rgba(255,255,255,0.25);color:white;padding:.4rem .6rem;border-radius:6px}

    .intro{display:flex;gap:2rem;padding:2rem;align-items:center}
    .intro img{max-width:320px;width:40%;border-radius:8px}
    .btn{background:var(--accent);color:white;padding:.6rem 1rem;border-radius:8px;text-decoration:none}

    .benefits-section{padding:1rem 2rem}
    .benefits-container{display:flex;gap:1.5rem}
    .testimonial{background:#fff;padding:1rem;border-radius:8px;box-shadow:0 6px 18px rgba(0,0,0,.06);width:240px}
    .testimonial img{width:100%;height:160px;object-fit:cover;border-radius:6px}
    .testimonial h3{margin:.5rem 0}
    .testimonial button{margin-top:.5rem;padding:.4rem .6rem;border-radius:6px;border:1px solid #ddd;background:#f7f7f7;cursor:pointer}
    .testimonial .add-to-cart{background:var(--accent);color:white;border:none}

    .cart-fab{position:fixed;right:1rem;bottom:1rem;background:var(--accent);color:white;border-radius:999px;padding:.8rem 1rem;box-shadow:0 10px 30px rgba(0,0,0,.2);display:flex;gap:.6rem;align-items:center;cursor:pointer}
    .cart-fab .count{background:rgba(255,255,255,.15);padding:4px 8px;border-radius:999px;font-weight:700}

    .modal-backdrop{position:fixed;inset:0;background:rgba(0,0,0,.5);display:none;align-items:center;justify-content:center;padding:1rem}
    .cart-modal{background:white;width:min(900px,96%);max-height:86vh;overflow:auto;border-radius:10px;padding:1rem}
    .cart-item{display:flex;gap:1rem;align-items:center;border-bottom:1px solid #eee;padding:.6rem 0}
    .cart-item img{width:72px;height:72px;object-fit:cover;border-radius:6px}
    .modal-actions{display:flex;justify-content:space-between;align-items:center;padding-top:1rem}
    .qty{display:flex;gap:.4rem;align-items:center}
    .small{font-size:.9rem;color:var(--muted)}

    footer{padding:1.5rem;background:#fafafa;color:#333;text-align:center;margin-top:2rem}
    @media (max-width:760px){.intro{flex-direction:column}.intro img{width:100%}}
  </style>
</head>
<body>

<header>
  <nav>
    <ul>
      <li><a href="index.html">Home</a></li>
      <li><a href="shop.html">Shop</a></li>
      <li><a href="about.html">Over Ons</a></li>
    </ul>
  </nav>

  <div id="points-display" style="color:white; font-weight:600;">Punten: <span id="points-value">0</span></div>
  <div class="translate-btn"><button onclick="location.href='../engels/shop.html'">üåê NL / EN</button></div>
</header>

<section class="intro">
  <div class="text">
    <h1>Premium Gerecycled 3D-Print Filament</h1>
    <p>Hoogwaardig, duurzaam filament geproduceerd uit gerecyclede materialen.</p>
    <a href="#filaments" class="btn">Bekijk Producten</a>
  </div>
  <img src="../assets/images/revoloop_filament.jpg" alt="3D Filament Rollen">
</section>

<section id="filaments" class="benefits-section">
  <h2>Onze Filamenten</h2>
  <div class="benefits-container" id="products">

    <div class="testimonial" data-id="pla-green" data-name="PLA ‚Äì Eco Groen" data-price="11.99" data-image="../assets/images/pla-green.jpg">
      <img src="../assets/images/pla-green.jpg" alt="PLA Groen Filament">
      <h3>PLA ‚Äì Eco Groen</h3>
      <p class="small">1.75mm ‚Ä¢ 1kg spoel</p>
      <p><strong>‚Ç¨11.99</strong></p>
      <button class="add-to-cart">Toevoegen aan winkelwagen</button>
    </div>

    <div class="testimonial" data-id="pla-black" data-name="PLA ‚Äì Diep Zwart" data-price="11.99" data-image="../assets/images/pla-black.jpeg">
      <img src="../assets/images/pla-black.jpeg" alt="PLA Zwart Filament">
      <h3>PLA ‚Äì Diep Zwart</h3>
      <p class="small">1.75mm ‚Ä¢ 1kg spoel</p>
      <p><strong>‚Ç¨11.99</strong></p>
      <button class="add-to-cart">Toevoegen aan winkelwagen</button>
    </div>

    <div class="testimonial" data-id="pla-recycled" data-name="PLA ‚Äì Gerecyclede Mix" data-price="11.99" data-image="../assets/images/pla-recycled.jpeg">
      <img src="../assets/images/pla-recycled.jpeg" alt="Gerecycled PLA Filament">
      <h3>PLA ‚Äì Gerecyclede Mix</h3>
      <p class="small">1.75mm ‚Ä¢ 750g eco-spoel</p>
      <p><strong>‚Ç¨11.99</strong></p>
      <button class="add-to-cart">Toevoegen aan winkelwagen</button>
    </div>

  </div>
</section>

<div class="cart-fab" id="cart-fab" title="Open winkelwagen">
  üõí <span id="cart-count" class="count">0</span>
</div>

<div class="modal-backdrop" id="cart-backdrop">
  <div class="cart-modal" role="dialog" aria-modal="true" aria-labelledby="cart-title">
    <h2 id="cart-title">Je winkelwagen</h2>
    <div id="cart-items"></div>

    <div class="modal-actions">
      <div class="small">Totaal: ‚Ç¨<span id="cart-total">0.00</span></div>

      <div style="display:flex; gap:0.5rem;">
        <button id="redeem-points">Gebruik Punten (max 30%)</button>
        <button id="continue-shopping">Verder winkelen</button>
        <button id="checkout" style="background:var(--accent);color:white;border:none;padding:.6rem 1rem;border-radius:6px;">Afrekenen</button>
      </div>
    </div>
  </div>
</div>

<footer>
  ¬© 2025 Revoloop ‚Äî Alle Rechten Voorbehouden
</footer>

<script>
if (!localStorage.getItem('userPoints')) {
  localStorage.setItem('userPoints', '5000');
}
function updatePointsDisplay(){
  document.getElementById('points-value').innerText = localStorage.getItem('userPoints');
}
updatePointsDisplay();

const CART_KEY = 'shop_cart_v1';
function loadCart(){
  try{ return JSON.parse(localStorage.getItem(CART_KEY)) || []; }catch(e){ return []; }
}
function saveCart(cart){ localStorage.setItem(CART_KEY, JSON.stringify(cart)); renderCartCount(); }

function addToCartFromCard(card, qty=1){
  const id = card.getAttribute('data-id');
  const name = card.getAttribute('data-name');
  const price = parseFloat(card.getAttribute('data-price')) || 0;
  const image = card.getAttribute('data-image') || '';
  let cart = loadCart();
  const existing = cart.find(i=>i.id===id);
  if(existing){ existing.qty += qty; }
  else { cart.push({id,name,price,qty,image}); }
  saveCart(cart);
  alert(name + ' is toegevoegd aan je winkelwagen');
}

document.querySelectorAll('.add-to-cart').forEach(btn=>{
  btn.addEventListener('click', e=>{
    const card = e.target.closest('.testimonial');
    addToCartFromCard(card,1);
  });
});

const cartFab = document.getElementById('cart-fab');
const backdrop = document.getElementById('cart-backdrop');
const cartItemsContainer = document.getElementById('cart-items');
const cartTotalEl = document.getElementById('cart-total');
const cartCountEl = document.getElementById('cart-count');

cartFab.addEventListener('click', ()=>{ openCart(); });
document.getElementById('continue-shopping').addEventListener('click', ()=>{ closeCart(); });
backdrop.addEventListener('click', (e)=>{ if(e.target === backdrop) closeCart(); });

function renderCartCount(){
  const cart = loadCart();
  const count = cart.reduce((s,i)=>s+i.qty,0);
  cartCountEl.innerText = count;
}

function openCart(){
  renderCart();
  backdrop.style.display = 'flex';
}
function closeCart(){ backdrop.style.display = 'none'; }

function renderCart(){
  const cart = loadCart();
  cartItemsContainer.innerHTML = '';
  if(cart.length===0){
    cartItemsContainer.innerHTML = '<p class="small">Je winkelwagen is leeg.</p>';
    cartTotalEl.innerText = '0.00';
    renderCartCount();
    return;
  }

  let total = 0;
  cart.forEach(item=>{
    total += item.price * item.qty;
    const el = document.createElement('div');
    el.className = 'cart-item';
    el.innerHTML = `
      <img src="${item.image}" alt="">
      <div style="flex:1">
        <div style="display:flex;justify-content:space-between;align-items:center">
          <strong>${item.name}</strong>
          <div>‚Ç¨${(item.price).toFixed(2)}</div>
        </div>
        <div class="small">id: ${item.id}</div>
      </div>
      <div style="display:flex;flex-direction:column;align-items:flex-end;gap:.4rem">
        <div class="qty">
          <button data-action="dec" data-id="${item.id}">‚àí</button>
          <span style="min-width:28px;text-align:center">${item.qty}</span>
          <button data-action="inc" data-id="${item.id}">+</button>
        </div>
        <button data-action="remove" data-id="${item.id}">Verwijder</button>
      </div>
    `;
    cartItemsContainer.appendChild(el);
  });

  cartTotalEl.innerText = total.toFixed(2);
  renderCartCount();
}

cartItemsContainer.addEventListener('click', (e)=>{
  const btn = e.target.closest('button');
  if(!btn) return;
  const action = btn.dataset.action;
  const id = btn.dataset.id;
  let cart = loadCart();
  const idx = cart.findIndex(i=>i.id===id);
  if(idx===-1) return;

  if(action==='inc'){ cart[idx].qty += 1; }
  else if(action==='dec'){ cart[idx].qty = Math.max(1, cart[idx].qty - 1); }
  else if(action==='remove'){ cart.splice(idx,1); }

  saveCart(cart);
  renderCart();
});

let discountApplied = false;

document.getElementById('redeem-points').addEventListener('click', () => {
    if (discountApplied) return alert("Je hebt al punten gebruikt voor deze bestelling.");

    let cart = loadCart();
    if (cart.length === 0) return alert("Je winkelwagen is leeg.");

    let total = cart.reduce((s, i) => s + i.price * i.qty, 0);
    let maxDiscount = total * 0.30;

    let userPoints = parseInt(localStorage.getItem('userPoints'));
    let pointValue = 0.01;

    let maxPointsUsable = Math.min(userPoints, maxDiscount / pointValue);
    if (maxPointsUsable < 1) return alert("Je hebt niet genoeg punten voor korting.");

    let pointsToUse = Math.floor(maxPointsUsable);

    let confirmUse = confirm(
        `Je kan ${pointsToUse} punten gebruiken voor een korting van ‚Ç¨${(pointsToUse * pointValue).toFixed(2)}.\nWil je deze korting toepassen?`
    );

    if (!confirmUse) return;

    total = total - (pointsToUse * pointValue);
    cartTotalEl.innerText = total.toFixed(2);

    let newBalance = userPoints - pointsToUse;
    localStorage.setItem('userPoints', newBalance);
    updatePointsDisplay();

    discountApplied = true;
    alert(`Korting toegepast! Je gebruikte ${pointsToUse} punten.`);
});

document.getElementById('checkout').addEventListener('click', ()=>{
  const cart = loadCart();
  if(cart.length===0){ alert('Je winkelwagen is leeg.'); return; }

  const name = prompt('Vul je naam in:');
  if(!name) return alert('Afrekenen geannuleerd.');
  const address = prompt('Vul je verzendadres in:');
  if(!address) return alert('Afrekenen geannuleerd.');

  const orders = JSON.parse(localStorage.getItem('orders') || '[]');
  const order = {
    id: 'ORD-' + Date.now(),
    name,
    address,
    items: cart,
    total: cart.reduce((s,i)=>s + i.qty*i.price,0),
    date: new Date().toISOString()
  };
  orders.push(order);
  localStorage.setItem('orders', JSON.stringify(orders));

  saveCart([]);
  renderCart();
  alert('Bedankt voor je bestelling! (simulatie). Order ID: ' + order.id);
  closeCart();
});

renderCartCount();
renderCart();
</script>

</body>
</html>
